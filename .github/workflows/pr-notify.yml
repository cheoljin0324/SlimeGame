name: Notify Discord on Push

on:
  push:
    branches:
      - main

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Get commit message
        id: commit
        run: |
          echo "COMMIT_MESSAGE=$(git log -1 --pretty=format:'%s')" >> $GITHUB_ENV

      - name: Send Discord Notification
        run: |
          curl -H "Content-Type: application/json" \
            -X POST \
            -d "{
              \"username\": \"ì•„ë¦¬ìŠ¤\",
              \"avatar_url\": \"https://cdn.discordapp.com/attachments/1412750974996709476/1412750990238814280/thumb_991469724_8c321a73_AIwLeP.png\",
              \"content\": \"ìš©ì‚¬ ì•„ë¦¬ìŠ¤ ë³´ê³ í•©ë‹ˆë‹¤! \\nğŸ“¢ **$GITHUB_ACTOR** ê°€ [$GITHUB_REPOSITORY]($GITHUB_SERVER_URL/$GITHUB_REPOSITORY)ì— ëª¨í—˜ë‹´ì„ ì˜¬ë ¸ìŠµë‹ˆë‹¤!\\në©”ì‹œì§€: $COMMIT_MESSAGE\"
            }" \
            ${{ secrets.DISCORD_WEBHOOK_URL }}
